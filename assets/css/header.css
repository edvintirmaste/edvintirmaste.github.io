/* Edvin Portfolio — header.css (v29.5)
   Scope: fixed top bar + identity; adds Fracture v1 overlay (shards-like refraction).
   Visual baseline identical to v29.1 unless fracture vars are present.
*/

/* ===== Tokens (expected from base.css) =====
   --header-h, --bar-top, --bar-btm, --bar-blur, --bar-sat exist in your project.
   Fracture-specific tokens below are safe defaults.
*/
:root{
  /* Fracture controls */
  --fracture-offset-y: 14px;      /* vertical offset of sampled layer */
  --fracture-opacity: 0.75;       /* overall strength */
  --fracture-contrast: 1.06;
  --fracture-saturate: 1.10;
  --fracture-bright: 1.03;
}

/* ===== Header bar ===== */
header.site-header{
  position: fixed;
  inset: 0 0 auto 0;
  height: var(--header-h);
  z-index: 20;
  background: linear-gradient(
    to bottom,
    rgba(2,2,28,var(--bar-top)),
    rgba(2,2,28,var(--bar-btm))
  );
  backdrop-filter: blur(var(--bar-blur)) saturate(var(--bar-sat));
  -webkit-backdrop-filter: blur(var(--bar-blur)) saturate(var(--bar-sat));
  /* FRACTURE (non-repeating): irregular horizontal mask to avoid band/square artifacts */
  -webkit-mask-image:
    linear-gradient(90deg,
      rgba(0,0,0,1) 0%, rgba(0,0,0,.94) 7%, rgba(0,0,0,1) 13%, rgba(0,0,0,.9) 21%,
      rgba(0,0,0,1) 29%, rgba(0,0,0,.94) 36%, rgba(0,0,0,1) 44%, rgba(0,0,0,.92) 52%,
      rgba(0,0,0,1) 60%, rgba(0,0,0,.94) 69%, rgba(0,0,0,1) 78%, rgba(0,0,0,.92) 86%,
      rgba(0,0,0,1) 100%);
  isolation: isolate; /* keep overlay blending contained */
}

/* ===== Fracture overlay =====
   This draws a second copy of the page background only inside the top bar,
   offsets it, and blends it to read as fractured/refraction.
   JS (main.js) sets the --fracture-bg-* variables at runtime from the actual page BG.
*/
header.site-header::after{
  content: "";
  position: absolute; inset: 0; pointer-events: none;
  opacity: var(--fracture-opacity);

  /* Re-draw background (populated by JS) */
  background-image: var(--fracture-bg-image, none);
  background-size: var(--fracture-bg-size, cover);
  background-repeat: no-repeat;
  background-attachment: var(--fracture-bg-attach, scroll);
  background-position:
    var(--fracture-bg-pos-x, 50%)
    calc(var(--fracture-bg-pos-y, 50%) + var(--fracture-offset-y));

  /* “Fracture” look via blend + subtle irregular edging */
  mix-blend-mode: overlay;
  filter:
    contrast(var(--fracture-contrast))
    saturate(var(--fracture-saturate))
    brightness(var(--fracture-bright));

  /* Mask to create irregular shard-ish edges across the bar */
  -webkit-mask-image:
    radial-gradient(120% 200% at 20% -20%, rgba(0,0,0,.75), transparent 70%),
    radial-gradient(140% 220% at 80% 120%, rgba(0,0,0,.9), transparent 80%),
    linear-gradient(105deg, black 48%, transparent 52%),
    linear-gradient(-75deg, black 49%, transparent 53%),
    linear-gradient(0deg, black, black); /* base fill */
  -webkit-mask-composite: source-over, source-over, source-over, source-over;
          mask-composite: add;
}

/* ===== Wordmark / content inside header (kept minimal; your existing markup will style as before) ===== */
header.site-header .wordmark{
  font-family: "Space Grotesk", Inter, system-ui, sans-serif;
  font-weight: 700;
  letter-spacing: .12em;
  text-transform: uppercase;
  filter: drop-shadow(0 0 8px rgba(180,200,255,.16));
}

/* Optional helper (if you have a container class inside header) */
header.site-header .inner{
  height: 100%;
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 0 16px;
}
