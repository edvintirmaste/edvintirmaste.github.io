/* Edvin Portfolio — header.css (v29.6)
   Base: v29.1 from playbook (keeps wordmark/brand intact), plus a new ::before overlay
   that fractures the page background only inside the top bar. */

/* ===== Header bar ===== */
header.site-header{
  position:fixed; inset:0 0 auto 0; height:var(--header-h); z-index:20;
  background: linear-gradient(to bottom, rgba(2,2,28,var(--bar-top)), rgba(2,2,28,var(--bar-btm)));
  backdrop-filter: blur(var(--bar-blur)) saturate(var(--bar-sat));
  -webkit-backdrop-filter: blur(var(--bar-blur)) saturate(var(--bar-sat));
  /* FRACTURE (organic, non-repeating) carrier on the bar itself */
  -webkit-mask-image:
    linear-gradient(90deg,
      rgba(0,0,0,1) 0%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 3%,
      rgba(0,0,0,1) 7%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 12%,
      rgba(0,0,0,1) 18%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 25%,
      rgba(0,0,0,1) 33%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 42%,
      rgba(0,0,0,1) 52%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 63%,
      rgba(0,0,0,1) 73%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 84%,
      rgba(0,0,0,1) 100%
    );
  isolation:isolate;
}

/* ===== NEW: Fracture overlay (only inside top bar) =====
   Draws a second copy of the page’s BG, offset vertically, then blends/masks to read as glass/prism.
   JS sets --fracture-url from .bg-wrap img (or body bg as fallback). */
:root{
  --fracture-offset-y: 14px;     /* vertical offset of sampled layer */
  --fracture-opacity: .75;       /* overall strength */
  --fracture-contrast: 1.06;
  --fracture-saturate: 1.10;
  --fracture-bright: 1.03;
}
header.site-header::before{
  content:"";
  position:absolute; inset:0; pointer-events:none;
  opacity: var(--fracture-opacity);

  /* re-draw the actual page background (set by JS) */
  background-image: var(--fracture-url, none);
  background-size: cover;
  background-repeat: no-repeat;
  /* keep aligned with viewport like your fixed bg; then nudge by offset */
  background-attachment: fixed;
  background-position: center calc(50% + var(--fracture-offset-y));

  /* fracture look: blend + gentle facet-like masking */
  mix-blend-mode: overlay;
  filter:
    contrast(var(--fracture-contrast))
    saturate(var(--fracture-saturate))
    brightness(var(--fracture-bright));

  /* simple multi-shard mask so it feels “fractured”, not just blurred */
  -webkit-mask-image:
    radial-gradient(130% 220% at -10% 0%, rgba(0,0,0,.95), transparent 70%),
    radial-gradient(120% 220% at 110% 100%, rgba(0,0,0,.85), transparent 78%),
    linear-gradient(102deg, black 49%, transparent 52%),
    linear-gradient(-78deg, black 50%, transparent 53%),
    linear-gradient(0deg, black, black);
  -webkit-mask-composite: source-over, source-over, source-over, source-over;
          mask-composite: add;
}

/* Seam-guard + vertical fade (kept from v29.1) */
header.site-header::after{
  content:"";
  position:absolute; left:0; right:0;
  top:100%;
  height: calc(var(--fade-depth) + 2px); /* +2px overlap kills line */
  transform: translateY(-2px);
  background: linear-gradient(to bottom, rgba(2,2,28,var(--bar-btm)), rgba(2,2,28,0));
  backdrop-filter: blur(var(--bar-blur)) saturate(var(--bar-sat));
  -webkit-backdrop-filter: blur(var(--bar-blur)) saturate(var(--bar-sat));
  -webkit-mask-image:
    linear-gradient(to bottom, rgba(0,0,0,98), rgba(0,0,0,0)),
    linear-gradient(90deg,
      rgba(0,0,0,1) 0%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 3%,
      rgba(0,0,0,1) 7%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 12%,
      rgba(0,0,0,1) 18%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 25%,
      rgba(0,0,0,1) 33%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 42%,
      rgba(0,0,0,1) 52%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 63%,
      rgba(0,0,0,1) 73%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 84%,
      rgba(0,0,0,1) 100%
    );
          mask-image:
    linear-gradient(to bottom, rgba(0,0,0,98), rgba(0,0,0,0)),
    linear-gradient(90deg,
      rgba(0,0,0,1) 0%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 3%,
      rgba(0,0,0,1) 7%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 12%,
      rgba(0,0,0,1) 18%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 25%,
      rgba(0,0,0,1) 33%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 42%,
      rgba(0,0,0,1) 52%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 63%,
      rgba(0,0,0,1) 73%,
      rgba(0,0,0,calc(1 - var(--fracture-strength))) 84%,
      rgba(0,0,0,1) 100%
    );
  pointer-events:none;
}

/* Nav container height/padding (from v29.1) */
.nav{
  height:var(--header-h);
  display:flex; align-items:center; justify-content:center;
  padding-inline: clamp(16px, 5vw, 64px);
}

/* Wordmark / brand (from v29.1 — unchanged) */
.brand{
  position:relative;
  width: clamp(var(--brand-min), var(--brand-fluid), var(--brand-max));
  display:flex; align-items:center; justify-content:space-between;
  text-transform:uppercase; white-space:nowrap; user-select:none;
  filter: drop-shadow(0 0 10px rgba(0,0,0,.45));
}
.brand::after{
  content:"";
  position:absolute; left:-14%; right:-14%; top:50%; height:56px;
  transform:translateY(-50%);
  background:
    radial-gradient(60% 140% at 22% 50%, rgba(var(--brand-glow1-rgb), var(--brand-glow-alpha)), rgba(0,0,0,0) 70%),
    radial-gradient(60% 140% at 78% 50%, rgba(var(--brand-glow2-rgb), var(--brand-glow-alpha)), rgba(0,0,0,0) 70%);
  filter: blur(18px);
  mix-blend-mode: screen;
  opacity:.95; z-index:-1; pointer-events:none;
}
.brand span{
  position:relative; display:inline-block;
  font-family:"Space Grotesk", Inter, system-ui;
  font-weight:700; font-size:var(--brand-size); line-height:1;
  text-shadow:0 0 16px rgba(180,205,255,.12);
}
.brand span:not(.space)::after{
  content:""; position:absolute; left:50%; top:50%;
  width:1.05em; height:1.05em; transform:translate(-50%,-50%);
  background: radial-gradient(closest-side, rgba(200,220,255,.06), rgba(0,0,0,0) 70%);
  filter: blur(7px);
  border-radius:50%; z-index:-1; pointer-events:none;
}
.brand .space{ flex:0 0 var(--word-gap); }
